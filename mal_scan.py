import os
import hashlib
import re

KNOWN_MALWARE_HASHES = {
    "79054025255fb1a26e4bc422aef54eb4": "Trojan.FakeAV",
    "9c5b5d5d5c5d5b5b5d5c5d5c5b5b5d5c": "Ransomware.Crysis",
    "5b5d5c5d5b5b5d5c5d5c5b5b5d5c5d5b": "Backdoor.Ginwui"
}

MALICIOUS_STRINGS = [
    "eval(",
    "base64_decode(",
    "system(",
    "exec(",
    "popen(",
    "passthru(",
    "shell_exec("
]


def scan_for_malware(directory):
    for root, dirs, files in os.walk(directory):
        for file in files:
            file_path = os.path.join(root, file)
            with open(file_path, "rb") as f:
                file_data = f.read()
                file_hash = hashlib.md5(file_data).hexdigest()
                if file_hash in KNOWN_MALWARE_HASHES:
                    print(
                        f"Detected malware by hash: {KNOWN_MALWARE_HASHES[file_hash]}")
                    print(f"Removing file: {file_path}")
                    os.remove(file_path)
                else:
                    for string in MALICIOUS_STRINGS:
                        if string in file_data:
                            print(f"Detected malware by string: {string}")
                            print(f"Removing file: {file_path}")
                            os.remove(file_path)


scan_for_malware("C:\\")
